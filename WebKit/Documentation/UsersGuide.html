<html>

<head>
	<link rel=STYLESHEET href="StyleSheet.css" type="text/css">
	<title>WebKit User's Guide</title>
</head>

<body>

<h1>WebKit User's Guide</h1>
Version 0.4
<br>Webware for Python 0.4


<a name=TOC><h2>Table of Contents</h2></a>

<p><font face="Helvetica">
<br>  <a href="#Synopsis"><font size=+1>Synopsis</font></a>
<br>  <a href="#Feedback"><font size=+1>Feedback</font></a>
<br>  <a href="#Introduction"><font size=+1>Introduction</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#Overview"><font size=>Overview</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#CompareCGIs"><font size=>Compared to CGI "apps"</font></a>
<br>  <a href="#Running"><font size=+1>Running and Testing</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#GettingStarted"><font size=>Getting Started</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#WebKitAdaptors"><font size=>WebKit Adaptors</font></a>
<br>  <a href="#Errors"><font size=+1>Errors / Uncaught Exceptions</font></a>
<br>  <a href="#Configuration"><font size=+1>Configuration</font></a>
<br>  <a href="#Administration"><font size=+1>Administration</font></a>
<br>  <a href="#ClassHierarchy"><font size=+1>Class Hierarchy</font></a>
<br>  <a href="#Debugging"><font size=+1>Debugging</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#Debugging_print"><font size=>print</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#Debugging_Raising"><font size=>Raising Exceptions</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#Debugging_Restarting"><font size=>Restarting the Server</font></a>
<br> &nbsp; &nbsp; &nbsp;  <a href="#Assertions"><font size=>Assertions</font></a>
<br>  <a href="#NamingConventions"><font size=+1>Naming Conventions</font></a>
<br>  <a href="#Actions"><font size=+1>Actions</font></a>
<br>  <a href="#PlugIns"><font size=+1>PlugIns</font></a>
<br>  <a href="#Files"><font size=+1>Files</font></a>
<br>  <a href="#How"><font size=+1>How do I develop an app?</font></a>
<br>  <a href="#KnownBugs"><font size=+1>Known Bugs</font></a>
<br>  <a href="#Credit"><font size=+1>Credit</font></a>
</font></p>


<a name=Synopsis><h2>Synopsis</h2></a>

<p> WebKit provides Python classes for generating dynamic content from a web-based, server-side application. It is a significantly more powerful alternative to CGI scripts for application-oriented development.


<a name=Feedback><h2>Feedback</h2></a>

<p> <p> You can e-mail <a href=mailto:webware-discuss@lists.sourceforge.net>webware-discuss@lists.sourceforge.net</a> to give feedback, discuss features and get help using WebKit.


<a name=Introduction><h2>Introduction</h2></a>

<a name=Overview><h3>Overview</h3></a>

<p> The core concepts of the WebKit are the Application, Servlet, Request, Response and Transaction, for which there are one or more Python classes.

<p> The application resides on the server-side and manages incoming requests in order to deliver them to servlets which then produce responses that get sent back to the client. A transaction is a simple container object that holds references to all of these objects and is accessible to all of them.

<p> Content is normally served in HTML or XML format over an HTTP connection. However, applications can provide other forms of content and the framework is designed to allow new classes for supporting protocols other than HTTP.

<p> In order to connect the web server and the application server, there is a small CGI script, WebKit.cgi, that bundles a web browser request and sends it to the application server, which then processes it and sends the response back to WebKit.cgi which then outputs the results for use by the web server. See the <a href=#Running>Running and Testing</a> section below.

<p> At a more detailed level, the process looks like this:

<ol>
	<li>At some point, someone has configured and run both a web server (such as Apache) and the WebKit app server (WebKit/AppServer.py).
	<li>A user requests a web page by typing a URL or submitting a form.
	<li>The user's browser sends the request to the remote web server.
	<li>The web server detects a CGI script, WebKit.cgi, in the URL and invokes it.
	<li>WebKit.cgi simply collects information about the request and sends it to the WebKit app server which is ready and waiting.
	<li>The app server asks the Application object to dispatch the raw request.
	<li>The application instantiates an HTTPRequest object and asks the appropriate Servlet (as determined by examining the URL) to process it.
	<li>The servlet generates content into a given HTTPResponse object, whose content is then sent back by the app server to WebKit.cgi.
	<li>WebKit.cgi prints the content which the web server then delivers to the user's web browser.
</ol>


<a name=CompareCGIs><h3>Compared to CGI "apps"</h3></a>

<p> The alternative to a server-side application is a set of CGI scripts. However, a CGI script must always be launched from scratch and many common tasks will be performed repeatedly for each request. For example, loading libraries, opening database connections, reading configuration files, etc.

<p> With the server-side application, the majority of these tasks can be done once at launch time and important  results can be easily cached. This the application significantly more efficient.

<p> Of course, CGIs can still be appropriate for "one shot" deals or simple applications. <a href=../../Documentation/Webware.html>Webware</a> includes a <a href=../../CGIWrapper/Documentation/CGIWrapper.html>CGI Wrapper</a> if you'd like to encapsulate your CGI scripts with robust error handling, e-mail notifications, etc.


<a name=Running><h2>Running and Testing</h2></a>

<a name=GettingStarted><h3>Getting Started</h3></a>

<p> You can put the whole Webware distribution in a directory such that your web server will accept URLs there, including CGIs, or you can put the distribution somewhere else and just put the WebKit.cgi file in an executable area of your Web Server's document tree.  If you choose to put only the WebKit.cgi file in your WebServer's path, you'll need to edit the WebKit.cgi and set the variable WebKitDir at the top of the file to the location of the <b>WebKit</b> directory, as in WebKitDir="/usr/local/Webware/WebKit".

For testing purposes, a URL might look something like:
<p><code>http://localhost/Projects/Webware/WebKit/WebKit.cgi/Welcome</code>
<p>or
<p><code>http://localhost/cgi-bin/WebKit.cgi/</code>


<p>Before you enter the URL into a browser, you need to start the WebKit app server from the command line:

<p><code>&gt; cd ~/Projects/Webware/WebKit
<br>&gt; AppServer.py
<br>WebKit AppServer 0.3
<br>part of Webware for Python
<br>Copyright 1999-2000 by Chuck Esterbrook. All Rights Reserved.
<br>WebKit and Webware are open source.
<br>Please visit:  http://webware.sourceforge.net
<br>
<br><i>&lt;a display of all settings and their values&gt;</i>
<br>
<br>Current directory is /usr/local/Webware/WebKit
<br>Plug-in: PSP in ../PSP
<br>Listening at ('', 8086)
<br>OK
</code>

<p><table bgcolor=#FFFFEE><tr><td>
Also, if you're on Windows, you will need to change the first line of WebKit.cgi, which specifies that the CGI script is a Python script. Try <code>#!python</code> which usually works, otherwise include the full path such as <code>#!\python\python</code>.
<br>
<br> Even on a UNIX system, you sometimes have to modify this first line, depending on whether or not you have <code>/usr/bin/env</code> and Python is in the search path. If not, then try using an absolute path such as <code>#!/usr/bin/python</code>.
</td></tr></table></p>


<p> Upon entering the URL, the results of the Welcome page should be displayed in your browser. Some diagnostic information will be printed in the terminal window of the server. You'll notice after the first page is served, that additional pages are served much faster. You can verify this in the console of the AppServer which reports the response time for each request. As the application warms up (e.g., caches classes, objects, files and settings) performance increases.

<p> The <b>Welcome</b> page has links to other examples which you can browse. There is also a link with each example for viewing the source.

<a name=WebKitAdaptors><h3>WebKit Adaptors</h3></a>

<p> A WebKit adaptor takes an HTTP request from a webserver and, as quickly as possible, packs it up and ships it to the AppServer which subsequently sends the response back to the adaptor for delivery to the web server and ultimately the web client. More concisely, an adaptor is the go-between of the web server and the app server.

<p> There are currently two adaptors in WebKit. The first is the CGI adaptor, named WebKit.cgi, which should work with any CGI-enabled web server. Of course, the web server will have to be configured to allow execution of CGI scripts.

<p> The second adaptor is the FastCGI adaptor, named WebKit.fcgi, which should result in faster responses (informal testing is generally at least twice as fast), although definitive performance tests have not yet been made on the adaptors. Your web server will have to be FastCGI enabled, which you may be able to accomplish by picking up software at <a href=http://www.FastCGI.com>http://www.FastCGI.com</a> where you can also learn more about FastCGI. There is also very useful documentation provided inline with the adaptor which you should read if you choose to use it.

<p> In the future, custom adaptors for popular web servers such as Apache, Microsoft, etc. should be provided in order to provide even better performance.


<a name=Errors><h2>Errors / Uncaught Exceptions</h2></a>

<p>One of the conveniences provided by WebKit is the handling of uncaught exceptions. The response to an uncaught exception is:

<ol>
	<li> Log the time, error, script name and traceback to AppServer's console.
	<li> Display a web page containing an apologetic message to the user.
	<li> Save a technical web page with debugging information so that developers can look at it after-the-fact. These HTML-based error messages are stored one-per-file, if the <code>SaveErrorMessages</code> setting is true (the default). They are stored in the directory named by the <code>ErrorMessagesDir</code> (defaults to 'ErrorMsgs').
	<li> Add an entry to the error log, found by default in <i>Logs/Errors.csv</i>.
	<li> E-mail the error message if the <code>EmailErrors</code> setting is true, using the settings <code>ErrorEmailServer</code> and <code>ErrorEmailHeaders</code>. You'll need to <a href=#Configuration>configure</a> these to active this feature.
</ol>

<p>Here is a <a href=SampleError.html>sample error page</a>.

<p>Archived error messages can be browsed through the <a href=#Administration>administration page</a>.

<p>Error handling behavior can be configured as described in <a href=#Configuration>Configuration</a>.</p>


<a name=Configuration><h2>Configuration</h2></a>

<p>There are several configuration parameters through which you can alter how WebKit behaves. They are described below, including their default values. Note that you can override the defaults by placing config files in the <code>Configs/</code> directory. A config file simply contains a Python dictionary containing the items you wish to override. For example:

<p><code>{
<br>&nbsp; &nbsp; &nbsp; 'ServletsDir': MyApp,
<br>&nbsp; &nbsp; &nbsp; 'ShowDebugInfoOnErrors': 1
<br>}</code>

<p><br><b>Configs/AppServer.config:</b>

<p>
<table border=2 align=center width=80% cellpadding=2 cellspacing=2>
<tr valign=top>
<td> <b>PrintConfigAtStartUp</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> Does pretty much what it says. It's generally a good idea to leave this on. </td>
</tr>
<tr valign=top>
<td> <b>Verbose</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> If true, then additional messages are printed while the AppServer runs, most notably information about each request such as size and response time. </td>
</tr>
<tr valign=top>
<td> <b>Port</b><br> &nbsp; &nbsp; <font size=-1>= 8086</font> </td> <td> The port that the application server runs on. Change this if there is a conflict with another application on your server. </td>
</tr>
<tr valign=top>
<td> <b>Multitasking</b><br> &nbsp; &nbsp; <font size=-1>= threading</font> </td> <td> Determines if and how the application server will multitask requests. Must be one of: threading, forking, sequencing. </td>
</tr>
<tr valign=top>
<td> <b>PlugIns</b><br> &nbsp; &nbsp; <font size=-1>= ['../PSP']</font> </td> <td> Loads the plug-ins from the given locations when the application server starts up. </td>
</tr>
</table>


<p><br><b>Configs/Application.config:</b>

<p>
<table border=2 align=center width=80% cellpadding=2 cellspacing=2>
<tr valign=top>
<td> <b>PrintConfigAtStartUp</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> Does pretty much what it says. It's generally a good idea to leave this on. </td>
</tr>
<tr valign=top>
<td> <b>ServletsDir</b><br> &nbsp; &nbsp; <font size=-1>= 'Examples'</font> </td> <td> This is where the application always looks for the servlets. This location does <b>not</b> appear in URLs; it's implicit. The path can be relative to the WebKit location, or an absolute path. </td>
</tr>
<tr valign=top>
<td> <b>LogActivity</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> If true, then the execution of each servlet is logged with useful information such as time, duration and whether or not an error occurred. </td>
</tr>
<tr valign=top>
<td> <b>ActivityLogFilename</b><br> &nbsp; &nbsp; <font size=-1>= 'Logs/Activity.csv'</font> </td> <td> This is the name of the file that servlet executions are logged to. This value makes no difference if <code>LogActivity</code> is false/0. The path can be relative to the WebKit location, or an absolute path. </td>
</tr>
<tr valign=top>
<td> <b>ActivityLogColumns</b><br> &nbsp; &nbsp; <font size=-1>--></font> </td> <td> <center><code>['request.remoteAddress', 'request.method', 'request.uri', 'response.size', 'servlet.name', 'request.timeStamp', 'transaction.duration', 'transaction.errorOccurred']</code></center><hr>Specifies the columns that will be stored in the activity log. Each column can refer to an object from the set [application, transaction, request, response, servlet, session] and then refer to its attributes using "dot notation". The attributes can be methods or instance attributes and can be qualified arbitrarily deep. </td>
</tr>
<tr valign=top>
<td> <b>ShowDebugInfoOnErrors</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> If true, then uncaught exceptions will not only display a message for the user, but debugging information for the developer as well. This includes the traceback, HTTP headers, form fields, environment and process ids. </td>
</tr>
<tr valign=top>
<td> <b>UserErrorMessage</b><br> &nbsp; &nbsp; <font size=-1>--></font> </td> <td> <center><code>'The site is having technical difficulties with this page. An error has been logged, and the problem will be fixed as soon as possible. Sorry!'</code></center><hr>This is the error message that is displayed to the user when an uncaught exception escapes the target CGI script. </td>
</tr>
<tr valign=top>
<td> <b>ErrorLogFilename</b><br> &nbsp; &nbsp; <font size=-1>= 'Logs/Errors.csv'</font> </td> <td> This is the name of the file where exceptions are logged. Each entry contains the date & time, filename, pathname, exception name & data, and the HTML error message filename (assuming there is one). </td>
</tr>
<tr valign=top>
<td> <b>SaveErrorMessages</b><br> &nbsp; &nbsp; <font size=-1>= 1</font> </td> <td> If true, then errors (e.g., uncaught exceptions) will produce an HTML file with both the user message and debugging information. Developers/administrators can view these files after the fact, to see the details of what went wrong. </td>
</tr>
<tr valign=top>
<td> <b>ErrorMessagesDir</b><br> &nbsp; &nbsp; <font size=-1>= 'ErrorMsgs'</font> </td> <td> This is the name of the directory where HTML error messages get stored. </td>
</tr>
<tr valign=top>
<td> <b>EmailErrors</b><br> &nbsp; &nbsp; <font size=-1>= 0</font> </td> <td> If true, error messages are e-mail out according to the ErrorEmailServer and ErrorEmailHeaders settings. This setting defaults to false because the other settings need to be configured first. </td>
</tr>
<tr valign=top>
<td> <b>ErrorEmailServer</b><br> &nbsp; &nbsp; <font size=-1>= 'mail.-.com'</font> </td> <td> The SMTP server to use for sending e-mail error messages. </td>
</tr>
<tr valign=top>
<td> <b>ErrorEmailHeaders</b><br> &nbsp; &nbsp; <font size=-1>--></font> </td> <td> <code><pre>{
    'From':         '-@-.com',
    'To':           ['-@-.com'],
    'Reply-to':     '-@-.com',
    'Content-type': 'text/html',
    'Subject':      'Error'
}</pre></code><hr>The e-mail MIME headers used for e-mailing error messages. Be sure to configure 'From', 'To' and 'Reply-to' before using this feature. </td>
</tr>
<tr valign=top>
<td> <b>Contexts</b><br> &nbsp; &nbsp; <font size=-1>--></font> </td> <td> <center><code>{ 'default':'Examples', 'Examples':'Examples'}</code></center><hr>Provides the directory locations for various 'contexts' which are determined from the URL. The key is the context name and the value is the directory, which can be a relative (to WebKit) or absolute path. The special key 'default' is used when a URL is not context specific. </td>
</tr>
<tr valign=top>
<td> <b>SessionTimeout</b><br> &nbsp; &nbsp; <font size=-1>= 60*60</font> </td> <td> Determines the amount of time (expressed in seconds) that passes before a user's session will timeout. When a session times out, all data associated with that session is lost. </td>
</tr>
<tr valign=top>
<td> <b>InstanceCacheSize</b><br> &nbsp; &nbsp; <font size=-1>= 10</font> </td> <td> Determines the maximum number of servlet instances that will be kept in memory to serve a particular URL. This limit keeps the server from overflowing objects under the stress of many simultaneous requests. </td>
</tr>
</table>


<a name=Administration><h2>Administration</h2></a>

<p> WebKit has a built-in administration page that you can access by specifying <code>_admin</code> in the URL. This gives basic information and provides links to other administrative features like viewing the logs and configuration.

<p> The error log display also contains links to the archived error messages so that you can browse them.

<p> The adminstration scripts provide further examples of writing pages with WebKit, so you may wish to examine their source.

<p> Here's an <a href=SampleAdmin.html>example</a> of the admin page.

<p> The URL might look something like:

<p><code>http://www.host.com/WebKit.cgi/_admin</code>


<a name=ClassHierarchy><h2>Class Hierarchy</h2></a>

<p> Below is the class hierarchy of WebKit. Classes are declared in a file of the same name, unless otherwise noted. Classes marked with an asteriks (*) have more than one superclass and therefore, will appear more than once in the listing.

<p> <font size=-1>(This table was generated using the classhier.py script found in Webware/DocSupport.)</font>

<p>
<table cellpadding=2 cellspacing=0 style="font-family: Arial, Helvetica, sans-serif; font-size: 14;">
<tr><td><b>Source</b></td><td><b>Class</b></td><td><b>File</b></td></tr>
<tr><td> <a href="Source/CanContainer.py.html">source</a> </td> <td>CanContainer</td><td></td></tr>
<tr><td> <a href="Source/Application.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application*</td><td></td></tr>
<tr><td> <a href="Source/Message.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message*</td><td></td></tr>
<tr><td> <a href="Source/Request.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request</td><td></td></tr>
<tr><td> <a href="Source/HTTPRequest.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTPRequest</td><td></td></tr>
<tr><td> <a href="Source/Response.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response</td><td></td></tr>
<tr><td> <a href="Source/HTTPResponse.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTPResponse</td><td></td></tr>
<tr><td> <a href="Source/Session.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Session*</td><td></td></tr>
<tr><td> <a href="Source/CanFactory.py.html">source</a> </td> <td>CanFactory</td><td></td></tr>
<tr><td> &nbsp; </td> <td>Exception</td><td></td></tr>
<tr><td> <a href="Source/AppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppServerError</td><td>AppServer.py</td></tr>
<tr><td> <a href="Source/Application.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ApplicationError</td><td>Application.py</td></tr>
<tr><td> <a href="Source/PlugIn.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlugInError</td><td>PlugIn.py</td></tr>
<tr><td> <a href="Source/Page.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PageError</td><td>Page.py</td></tr>
<tr><td> <a href="Source/Configurable.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConfigurationError</td><td>Configurable.py</td></tr>
<tr><td> <a href="Source/Session.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionError</td><td>Session.py</td></tr>
<tr><td> &nbsp; </td> <td>NamedValueAccess</td><td></td></tr>
<tr><td> <a href="Source/Object.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object</td><td></td></tr>
<tr><td> <a href="Source/PlugIn.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlugIn</td><td></td></tr>
<tr><td> <a href="Source/Configurable.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Configurable</td><td></td></tr>
<tr><td> <a href="Source/AppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AppServer</td><td></td></tr>
<tr><td> <a href="Source/AsyncThreadedAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AsyncThreadedAppServer*</td><td></td></tr>
<tr><td> <a href="Source/OneShotAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OneShotAppServer</td><td></td></tr>
<tr><td> <a href="Source/ThreadedAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThreadedAppServer</td><td></td></tr>
<tr><td> <a href="Source/Application.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application*</td><td></td></tr>
<tr><td> <a href="Source/Adapter.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adapter</td><td></td></tr>
<tr><td> <a href="Source/OneShotAdapter.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OneShotAdapter</td><td></td></tr>
<tr><td> <a href="Source/Cookie.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cookie</td><td></td></tr>
<tr><td> <a href="Source/ExceptionHandler.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExceptionHandler</td><td></td></tr>
<tr><td> <a href="Source/SessionStore.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionStore</td><td></td></tr>
<tr><td> <a href="Source/SessionMemoryStore.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionMemoryStore</td><td></td></tr>
<tr><td> <a href="Source/SessionFileStore.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SessionFileStore</td><td></td></tr>
<tr><td> <a href="Source/Message.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Message*</td><td></td></tr>
<tr><td> <a href="Source/Request.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Request</td><td></td></tr>
<tr><td> <a href="Source/HTTPRequest.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTPRequest</td><td></td></tr>
<tr><td> <a href="Source/Response.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response</td><td></td></tr>
<tr><td> <a href="Source/HTTPResponse.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTPResponse</td><td></td></tr>
<tr><td> <a href="Source/Servlet.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Servlet</td><td></td></tr>
<tr><td> <a href="Source/HTTPServlet.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTPServlet</td><td></td></tr>
<tr><td> <a href="Source/Page.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Page</td><td></td></tr>
<tr><td> <a href="Source/SidebarPage.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SidebarPage</td><td></td></tr>
<tr><td> <a href="Source/UnknownFileType.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnknownFileTypeServlet</td><td>UnknownFileType.py</td></tr>
<tr><td> <a href="Source/ServletFactory.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServletFactory</td><td></td></tr>
<tr><td> <a href="Source/ServletFactory.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PythonServletFactory</td><td>ServletFactory.py</td></tr>
<tr><td> <a href="Source/UnknownFileType.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnknownFileTypeServletFactory</td><td>UnknownFileType.py</td></tr>
<tr><td> <a href="Source/Session.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Session*</td><td></td></tr>
<tr><td> <a href="Source/Transaction.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Transaction</td><td></td></tr>
<tr><td> &nbsp; </td> <td>NotImplementedError</td><td></td></tr>
<tr><td> <a href="Source/Common.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubclassResponsibilityError</td><td>Common.py</td></tr>
<tr><td> <a href="Source/Common.py.html">source</a> </td> <td>Tombstone</td><td>Common.py</td></tr>
<tr><td> <a href="Source/FCGIAdaptor.py.html">source</a> </td> <td>WKFCGI</td><td>FCGIAdaptor.py</td></tr>
<tr><td> &nbsp; </td> <td>asyncore.dispatcher</td><td></td></tr>
<tr><td> <a href="Source/AsyncThreadedAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AsyncThreadedAppServer*</td><td></td></tr>
<tr><td> <a href="Source/ThreadedAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RequestHandler</td><td>ThreadedAppServer.py</td></tr>
<tr><td> <a href="Source/AsyncThreadedAppServer.py.html">source</a> </td> <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Monitor</td><td>AsyncThreadedAppServer.py</td></tr>
</table></p>


<a name=Debugging><h2>Debugging</h2></a>

<p> As will all software development, you will need to debug your web application. The most popular techniques are detailed below.


<a name=Debugging_print><h3>print</h3></a>

<p> The most common technique is the infamous <code>print</code> statement. The results of <code>print</code> statements go to the console where the WebKit application server was started (not to the HTML page as would happen with CGI). Prefixing the debugging output with a special tag (such as >>) is useful because it stands out on the console and you can search for the tag in source code to remove the print statements after they are no longer useful. For example:

<p><code>print '<b>&gt;&gt;</b> fields =', self._request.fields()</code>


<a name=Debugging_Raising><h3>Raising Exceptions</h3></a>

<p> Uncaught expections are trapped at the application level where a useful error page is saved with information such as the traceback, environment, fields, etc. You can configure the application to automatically e-mail you this information. Here is an <a href=SampleError.html>example error page</a>.

<p> When an application isn't behaving correctly, raising an exception can be useful because of the additional information that comes with it. Exceptions can be coupled with messages, thereby turning them into more powerful versions of the <code>print</code> statement. For example:

<p><code>raise Exception, 'self = %s' % self</code>


<a name=Debugging_Restarting><h3>Restarting the Server</h3></a>

<p> Servlet <i>super classes</i> don't get reloaded by the AppServer. Also, Webware can still be unstable due to it's early age. If a problem becomes unsolvable, restart the server and see if it still occurs on the first attempt.


<a name=Assertions><h3>Assertions</h3></a>

<p> Assertions are used to ensure that the internal conditions of the application are as expected. An assertion is equivalent to an <code>if</code> statement coupled with an exception. For example:

<p><code>assert shoppingCart.total()>=0.0, 'shopping cart total is %0.2f' % shoppingCart.total()</code>


<a name=NamingConventions><h2>Naming Conventions</h2></a>

<p>Cookies and form values that are named with surrounding underscores (such as <code>_sid_</code> and <code>_action_</code>) are reserved by WebKit for it's own internal purposes. If you refrain from using surrounding underscores in your own names, then [a] you won't accidentally clobber an already existing internal name and [b] when new names are introduced by future versions of WebKit, they won't break your application.


<a name=Actions><h2>Actions</h2></a>

<p> Suppose you have a web page with a form and one or more buttons. Normally, when the form is submitted, a method such as Servlet's <code>respondToPost()</code> or Page's <code>writeHTML()</code>, will be invoked. However, you may find it more useful to bind the button to a specific method of your servlet such as <code>new()</code>, <code>remove()</code> etc. to implement the command, and reserve <code>writeHTML()</code> for displaying the page. Note that your "command methods" can then invoke <code>writeHTML()</code> after performing their task.

<p> The <i>action</i> feature of Page let's you do this. The process goes like this:

<p> <b>1.</b> Add buttons to your HTML form of type <code>submit</code> and name <code>_action_</code>. For example:

<p><code>&lt;input name=_action_ type=submit value=New&gt;
<br>&lt;input name=_action_ type=submit value=Delete&gt;</code>

<p> <b>2.</b> Add an <code>actions()</code> method to your class to state which actions are valid. This is security requirement is important. Without it, hackers could invoke any servlet method they wanted! For example:

<p> <code>def actions(self): return <i>SuperClass</i>.actions(self) + ['New', 'Delete']</code>

<p> <b>3.</b> Unfortunately, the HTML submit button does not separate it's value from it's title/label. If your button labels don't match your method names, you will need to implement <code>methodNameForAction()</code> to provide the mapping. You could simply use a dictionary to create the mapping, or if you know there is some relationship you could write the logic for it. For example,

<p><code>def methodNameForAction(self, name): return string.lower(name)</code>

<p> <b>4.</b> Now you implement your action methods.

<p> The ListBox example shows the use of actions.


<a name=PlugIns><h2>Plug-ins</h2></a>

<p>	A plug-in is a software component that is loaded by WebKit in order to provide additional WebKit functionality without necessarily having to modify WebKit's source.

<p>The most infamous plug-in is PSP (Python Server Pages) which ships with Webware.

<p> Plug-ins often provide additional servlet factories, servlet subclasses, examples and documentation. Ultimately, it is the plug-in author's choice as to what to provide and in what manner.

<p> Technically, plug-ins are Python packages that follow a few simple conventions in order to work with WebKit. More information can be found in PlugIn.py's doc strings. You can learn more about Python packages in the Python Tutorial, 6.4: "Packages" at http://www.python.org/doc/current/tut/node8.html#SECTION008400000000000000000).


<a name=Files><h2>Files</h2></a>

<p> <b>*.py</b> - Mostly the implementation of the various classes of the framework, except as noted below.

<p> <b>WebKit.cgi</b> - A simple script that imports and runs WebKitCGIAdaptor. This also results in a cached byte code version of WebKitCGIAdapator (e.g., a <code>.pyc</code>) (provided you have write permission, of course).

<p> <b>CGIAdaptor.py</b> - A program that collects HTTP requests together in a dictionary and passes them to the app server for processing. This allows WebKit applications to work with any web server that supports CGI.

<p> <b>FCGIAdaptor.py</b> - Like CGIAdaptor, but in accordance with the <a href=http://www.fastcgi.com>FastCGI</a> protocol for improved performance.

<p> <b>address.text</b> - The hostname and port of the AppServer are written to this file when it starts up. The CGI and FastCGI adaptors read this in order to communicate with the AppServer.

<p> <b>Config/AppServer.config</b> - configuration file for the AppServer

<p> <b>Config/Application.config</b> - configuration file for the Application

<p> <b>Logs/Access.csv</b> - The log of servlets/pages accessed through the server as described above.

<p> <b>Logs/Errors.csv</b> - The log of uncaught exceptions including date & time, exception and link to debugging page if one was saved.

<p> <b>ErrorMsgs/Error-<i>scriptname</i>-<i>YYYY</i>-<i>MM</i>-<i>DD</i>-<i>*</i>.py</b> - Archived error messages.


<a name=How><h2>How do I develop an app?</h2></a>

<p> The answer to that question might not seem clear after being deluged with all the details. Here's a summary:

<ol>
	<li> Make sure you can run the WebKit AppServer. See the <a href=#Running>Running and Testing</a> section.
	<li> Read the source to the examples (in WebKit/Examples), then modify one of them to get your toes wet.
	<li> Create your own new example from scratch. Ninety-nine percent of the time you will be subclassing the <b>Page</b> class.
	<li> Familiarize yourself with the class docs in order to take advantage of classes like Page, HTTPRequest, HTTPResponse and Session. Unfortunately, I couldn't get generated class docs working for this release, so you'll have to resort to breezing through the source code which is coupled with documentation strings. Read the examples first.
	<li> With this additional knowledge, create more sophisticated pages.
	<li> Contribute enhancements and bug fixes back to the project. &nbsp; <kbd>:-)</kbd>
	<li> Make sure you find out about new versions when they're released: Subscribe to the announcements list at <a href=http://lists.sourceforge.net/mailman/listinfo/webware-announce>http://lists.sourceforge.net/mailman/listinfo/webware-announce</a>.

</ol>


<a name=KnownBugs><h2>Known Bugs</h2></a>

<p> Known bugs and future work in general, is documented in <a href=Future.html>Future.html</a>.


<a name=Credit><h2>Credit</h2></a>

<p> Authors: Chuck Esterbrook, Jay Love

<p> Several people, mostly on the webware-discuss mailing list, have provided feedback and testing.

<p> The design was inspired by both Apple's WebObjects and Java's Servlets.

<p> The Python SocketServer module was useful in creating the app server.



<p><hr>

</body>
</html>
