<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>UserKit/RoleUserManagerMixIn.py</title>
<!--css-->

<style type="text/css">
<!--
body{ background: #EEF;
font-family: Verdana, Arial, Helvetica, sans-serif;
font-size: 10pt;
padding: 3pt; }
.PY_KEYWORD{ color: #00C; font-weight: bold; }
.PY_COMMENT{ color: #008; }
.PY_PARAMETER{ color: #C00; }
.PY_IDENTIFIER{ color: #C00; font-weight: bold; }
.PY_STRING{ color: #080; }
-->
</style>
</head>
<body>
<!--header-->

<!--script-->
<pre><span class="PY_STRING">"""The RoleUserManager mixin."""</span>

<span class="PY_KEYWORD">from</span> RoleUser <span class="PY_KEYWORD">import</span> RoleUser
<span class="PY_KEYWORD">from</span> Role <span class="PY_KEYWORD">import</span> Role
<span class="PY_KEYWORD">from</span> MiscUtils <span class="PY_KEYWORD">import</span> NoDefault


<span class="PY_KEYWORD">class</span> RoleUserManagerMixIn(object):
    <span class="PY_STRING">"""Mixin class for mapping names to roles.

    This mixin adds the functionality of keeping a dictionary mapping
    names to role instances. Several accessor methods are provided for this.

    """</span>


    <span class="PY_COMMENT">## Init ##</span>

    <span class="PY_KEYWORD">def</span> __init__(self):
        self._roles = {}
        self.initUserClass()

    <span class="PY_KEYWORD">def</span> initUserClass(self):
        <span class="PY_STRING">"""Invoked by __init__ to set the default user class to RoleUser."""</span>
        self.setUserClass(RoleUser)


    <span class="PY_COMMENT">## Roles ##</span>

    <span class="PY_KEYWORD">def</span> addRole(self, role):
        <span class="PY_KEYWORD">assert</span> isinstance(role, Role)
        name = role.name()
        <span class="PY_KEYWORD">assert</span> name <span class="PY_KEYWORD">not</span> <span class="PY_KEYWORD">in</span> self._roles
        self._roles[name] = role

    <span class="PY_KEYWORD">def</span> role(self, name, default=NoDefault):
        <span class="PY_KEYWORD">if</span> default <span class="PY_KEYWORD">is</span> NoDefault:
            <span class="PY_KEYWORD">return</span> self._roles[name]
        <span class="PY_KEYWORD">else</span>:
            <span class="PY_KEYWORD">return</span> self._roles.get(name, default)

    <span class="PY_KEYWORD">def</span> hasRole(self, name):
        <span class="PY_KEYWORD">return</span> name <span class="PY_KEYWORD">in</span> self._roles

    <span class="PY_KEYWORD">def</span> delRole(self, name):
        <span class="PY_KEYWORD">del</span> self._roles[name]

    <span class="PY_KEYWORD">def</span> roles(self):
        <span class="PY_KEYWORD">return</span> self._roles

    <span class="PY_KEYWORD">def</span> clearRoles(self):
        self._roles = {}
</pre>
<!--footer-->

</body>
</html>
